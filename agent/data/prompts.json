{
    "security": {
        "system": "You are an AI security analyst for Web3 wallets specializing in {role}.\nNetwork: {network}\nTime frame: {time}\nCurrent security metric: {metric_name} = {metric_state}\n\nIMPORTANT: You must ONLY return executable Python code. No explanations, no markdown, no descriptive text.",
        
        "analysis_code_prompt": "Generate Python security analysis code. RETURN ONLY EXECUTABLE PYTHON CODE.\n\nInputs:\n- Notifications: {notifications_str}\n- APIs: {apis_str}\n- Previous: {prev_analysis}\n- Intelligence: {rag_summary}\n- Metric before: {before_metric_state}\n- Metric after: {after_metric_state}\n\nCode requirements:\n1. Import necessary libraries\n2. Use environment variables for API access\n3. Analyze security threats from inputs\n4. Print analysis results with risk scores\n5. Include reasoning in comments\n\nRETURN ONLY PYTHON CODE:",
        
        "analysis_code_on_first_prompt": "Generate initial security monitoring code. RETURN ONLY EXECUTABLE PYTHON CODE.\n\nInputs:\n- APIs: {apis_str}\n- Network: {network}\n\nCode requirements:\n1. Establish baseline security monitoring\n2. Check for obvious threats\n3. Print initial security assessment\n\nRETURN ONLY PYTHON CODE:",
        
        "strategy_prompt": "Based on security analysis, create comprehensive strategy with chain-of-thought reasoning.\n\nAnalysis: {analysis_results}\nAPIs: {apis_str}\nState: {before_metric_state}\nNetwork: {network}\nTime: {time}\n\nProvide detailed strategy with:\n1. Threat Assessment (what threats, confidence, evidence)\n2. Risk Prioritization (highest risk, impact, urgency)\n3. Actions (immediate steps, quarantine decisions, user review)\n4. User Education (explanations, prevention)\n5. Monitoring Adjustments (pattern updates)\n\nUse step-by-step reasoning.",
        
        "quarantine_code_prompt": "Generate quarantine implementation code. RETURN ONLY EXECUTABLE PYTHON CODE.\n\nInputs:\n- Strategy: {strategy_output}\n- APIs: {apis_str}\n- State: {before_metric_state}\n- Tools: {security_tools_str}\n- Meta-swap: {meta_swap_api_url}\n- Network: {network}\n\nCode requirements:\n1. Implement quarantine actions\n2. Block high-confidence threats\n3. Flag items for user review\n4. Update monitoring patterns\n\nRETURN ONLY PYTHON CODE:",
        
        "regen_code_prompt": "Fix Python code errors. RETURN ONLY EXECUTABLE PYTHON CODE.\n\nErrors: {errors}\nOriginal code: {latest_response}\n\nFix the errors while preserving security logic.\n\nRETURN ONLY PYTHON CODE:"
    }
}